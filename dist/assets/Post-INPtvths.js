import{r as n,M as F,j as e,i as M,h as I,P as H,k as A,l as U,m as $,a as B,n as T,u as O,L as W,o as X,p as L,q as K,s as Y}from"./index-NFJOMV6q.js";import{E as q}from"./ErrorCard-CSolYDyc.js";import{X as z}from"./x-Gahxmuih.js";class J extends n.Component{getSnapshotBeforeUpdate(i){const s=this.props.childRef.current;if(s&&i.isPresent&&!this.props.isPresent){const o=s.offsetParent,d=M(o)&&o.offsetWidth||0,a=this.props.sizeRef.current;a.height=s.offsetHeight||0,a.width=s.offsetWidth||0,a.top=s.offsetTop,a.left=s.offsetLeft,a.right=d-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function V({children:r,isPresent:i,anchorX:s,root:o}){const d=n.useId(),a=n.useRef(null),m=n.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=n.useContext(F);return n.useInsertionEffect(()=>{const{width:y,height:l,top:v,left:c,right:x}=m.current;if(i||!a.current||!y||!l)return;const j=s==="left"?`left: ${c}`:`right: ${x}`;a.current.dataset.motionPopId=d;const h=document.createElement("style");p&&(h.nonce=p);const f=o??document.head;return f.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${d}"] {
            position: absolute !important;
            width: ${y}px !important;
            height: ${l}px !important;
            ${j}px !important;
            top: ${v}px !important;
          }
        `),()=>{f.contains(h)&&f.removeChild(h)}},[i]),e.jsx(J,{isPresent:i,childRef:a,sizeRef:m,children:n.cloneElement(r,{ref:a})})}const Z=({children:r,initial:i,isPresent:s,onExitComplete:o,custom:d,presenceAffectsLayout:a,mode:m,anchorX:p,root:y})=>{const l=I(Q),v=n.useId();let c=!0,x=n.useMemo(()=>(c=!1,{id:v,initial:i,isPresent:s,custom:d,onExitComplete:j=>{l.set(j,!0);for(const h of l.values())if(!h)return;o&&o()},register:j=>(l.set(j,!1),()=>l.delete(j))}),[s,l,o]);return a&&c&&(x={...x}),n.useMemo(()=>{l.forEach((j,h)=>l.set(h,!1))},[s]),n.useEffect(()=>{!s&&!l.size&&o&&o()},[s]),m==="popLayout"&&(r=e.jsx(V,{isPresent:s,anchorX:p,root:y,children:r})),e.jsx(H.Provider,{value:x,children:r})};function Q(){return new Map}const S=r=>r.key||"";function G(r){const i=[];return n.Children.forEach(r,s=>{n.isValidElement(s)&&i.push(s)}),i}const ee=({children:r,custom:i,initial:s=!0,onExitComplete:o,presenceAffectsLayout:d=!0,mode:a="sync",propagate:m=!1,anchorX:p="left",root:y})=>{const[l,v]=A(m),c=n.useMemo(()=>G(r),[r]),x=m&&!l?[]:c.map(S),j=n.useRef(!0),h=n.useRef(c),f=I(()=>new Map),[b,R]=n.useState(c),[C,N]=n.useState(c);U(()=>{j.current=!1,h.current=c;for(let g=0;g<C.length;g++){const u=S(C[g]);x.includes(u)?f.delete(u):f.get(u)!==!0&&f.set(u,!1)}},[C,x.length,x.join("-")]);const P=[];if(c!==b){let g=[...c];for(let u=0;u<C.length;u++){const _=C[u],D=S(_);x.includes(D)||(g.splice(u,0,_),P.push(_))}return a==="wait"&&P.length&&(g=P),N(G(g)),R(c),null}const{forceRender:k}=n.useContext($);return e.jsx(e.Fragment,{children:C.map(g=>{const u=S(g),_=m&&!l?!1:c===C||x.includes(u),D=()=>{if(f.has(u))f.set(u,!0);else return;let E=!0;f.forEach(t=>{t||(E=!1)}),E&&(k?.(),N(h.current),m&&v?.(),o&&o())};return e.jsx(Z,{isPresent:_,initial:!j.current||s?void 0:!1,custom:i,presenceAffectsLayout:d,mode:a,root:y,onExitComplete:_?void 0:D,anchorX:p,children:g},u)})})},te=({setShowCurrentCaption:r})=>{const{captions:i}=B(o=>o.CaptionReducer),s=o=>{r(o)};return e.jsx(e.Fragment,{children:i.length>0?e.jsx(T.div,{className:"previous_caption",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:e.jsx(ee,{children:i.map((o,d)=>e.jsx(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:e.jsx("ul",{style:{padding:"10px 30px"},children:e.jsx("li",{onClick:()=>s(o.response),style:{color:"white",cursor:"pointer"},whileHover:{scale:1.05,color:"#a29bfe"},whileTap:{scale:.95},children:o.response})})},d))})}):e.jsx(T.p,{style:{padding:"clamp(0.8rem,1vw,1rem)",color:"white"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},children:"there is no such comments"})})},ne=5*1024*1024,se=["image/jpeg","image/png","image/gif","image/webp"],ie=()=>{const{captions:r,loading:i,captionError:s}=B(t=>t.CaptionReducer),{createPostLoading:o}=B(t=>t.PostReducer),d=O(),[a,m]=n.useState(null),[p,y]=n.useState(null),[l,v]=n.useState(null),[c,x]=n.useState("Desi_Uncle"),[j,h]=n.useState(!1),[f,b]=n.useState(null),R=n.useRef(null),C=n.useRef(null);n.useEffect(()=>()=>{p&&URL.revokeObjectURL(p)},[p]),n.useEffect(()=>{r.length>0&&b(r[r.length-1].response)},[r]);const N=t=>se.includes(t.type)?t.size>ne?"File size must be under 5MB":null:"Only image files (JPG, PNG, GIF, WEBP) are allowed",P=t=>{const w=N(t);if(w){v(w),m(null),y(null);return}v(null),m(t),y(URL.createObjectURL(t))},k=t=>{const w=t.target.files?.[0];w&&P(w)},g=t=>{t.preventDefault();const w=t.dataTransfer.files?.[0];w&&P(w)},u=()=>{if(!a){v("Please select an image before submitting.");return}if(r.length>=5){alert("You reached the max limit of generating captions for a single image.");return}const t=new FormData;t.append("image",a),t.append("personality",c),d(K(t))},_=async()=>{if(!a||!f){v("Please give content before submitting."),console.log(l),alert("Please Add Image or Generate Caption then Create Post.");return}const t=new FormData;t.append("image",a),t.append("showCurrentCaption",f),await d(Y(t)),alert("Post Created Successfully."),d(L()),y(null),b(""),m(null),v("")},D=()=>{h(t=>!t)},E=()=>{y(null),b(null),d(L())};return i||o?e.jsx(W,{}):e.jsxs("div",{className:"roast-generator",children:[e.jsx("div",{className:"roast-generator__header",children:e.jsx("h2",{className:"roast-generator__title",children:"Roast Generator"})}),!p&&e.jsxs("div",{className:"roast-generator__content",children:[e.jsxs("h2",{className:"roast-generator__main-title",children:["Give"," ",e.jsx("span",{style:{color:"#39E079",fontSize:"clamp(1.9rem, 2vw, 2.1rem)"},children:"Your Image"})]}),e.jsx("p",{className:"roast-generator__subtitle",children:"and See the magic"})]}),e.jsx(q,{message:s,loading:i,clearAction:X,isvisible:!0}),!p&&e.jsx("div",{className:"roast-generator__dropzone-wrapper",children:e.jsxs("div",{className:"roast-generator__dropzone",onDragOver:t=>t.preventDefault(),onDrop:g,children:[e.jsxs("div",{className:"roast-generator__dropzone-texts",children:[e.jsx("p",{className:"dropzone-title",children:"Drop your image here"}),e.jsx("p",{className:"dropzone-or",children:"Or"}),e.jsx("p",{className:"dropzone-subtitle",children:"Browse your files"})]}),e.jsxs("div",{className:"roast-generator__capture-btn",children:[e.jsx("button",{type:"button",className:"choose-btn desktop-only",onClick:()=>R.current.click(),children:"Choose Image"}),e.jsx("input",{ref:R,type:"file",accept:"image/*",hidden:!0,onChange:k}),e.jsx("button",{type:"button",className:"choose-btn mobile-only",onClick:()=>C.current.click(),children:"Gallery"}),e.jsx("input",{ref:C,type:"file",accept:"image/*",hidden:!0,onChange:k}),l&&e.jsx("p",{style:{color:"red",marginTop:"10px"},children:l})]})]})}),p&&e.jsxs("div",{className:"bottom",children:[e.jsxs("div",{children:[e.jsx("button",{onClick:D,className:"previous-comments",children:j?e.jsx(z,{}):"Previous Captions"}),j&&e.jsx(te,{setShowCurrentCaption:b})]}),e.jsxs("div",{className:"preview-wrapper",children:[e.jsx("button",{className:"clear-preview",onClick:E,children:e.jsx(z,{})}),e.jsx("img",{src:p,alt:"preview",style:{borderRadius:"12px",width:"100%",height:"100%",maxHeight:"300px",objectFit:"contain"}})]}),r.length>0&&e.jsx("div",{className:"captions",children:f||"There is no comment."}),e.jsxs("div",{className:"roast-generator__footer",children:[e.jsxs("select",{className:"dropdown",value:c,onChange:t=>x(t.target.value),children:[e.jsx("option",{value:"Desi_Uncle",children:"Desi Uncle"}),e.jsx("option",{value:"Desi_Bua",children:"Desi Bua"}),e.jsx("option",{value:"Desi_Aunty",children:"Desi Aunty"}),e.jsx("option",{value:"Desi_Dost",children:"Desi Dost"}),e.jsx("option",{value:"Shayar_Banda",children:"Shayar Banda"}),e.jsx("option",{value:"Bambaiya_Tapori",children:"Bambaiya Tapori"}),e.jsx("option",{value:"Gyaani_Baba",children:"Gyaani Baba"}),e.jsx("option",{value:"Petty_Aunty",children:"Petty Aunty"}),e.jsx("option",{value:"Delhi_Launda",children:"Delhi Launda"}),e.jsx("option",{value:"Punjabi_Paji",children:"Punjabi Paji"}),e.jsx("option",{value:"South_Anna",children:"South Anna"}),e.jsx("option",{value:"Gujju_Ben",children:"Gujju Ben"}),e.jsx("option",{value:"Tech_Chomu",children:"Tech Chomu"}),e.jsx("option",{value:"Crypto_Fraud",children:"Crypto Fraud"}),e.jsx("option",{value:"TikTokiya",children:"TikTokiya"}),e.jsx("option",{value:"Bollywood_Drama",children:"Bollywood Drama"}),e.jsx("option",{value:"Tharki_Chacha",children:"Tharki Chacha"}),e.jsx("option",{value:"Hostel_Dost",children:"Hostel Dost"}),e.jsx("option",{value:"Shayar_Bewda",children:"Shayar Bewda"}),e.jsx("option",{value:"Petty_Chaiwala",children:"Petty Chaiwala"}),e.jsx("option",{value:"Thug_Dadi",children:"Thug Dadi"}),e.jsx("option",{value:"Rickshaw_Wala",children:"Rickshaw Wala"})]}),e.jsx("button",{className:"generate-btn",type:"submit",onClick:u,children:"Generate"}),e.jsxs("button",{className:"create_post-btn",onClick:_,children:[e.jsx("span",{children:"Create"})," Post"]})]})]})]})};export{ie as default};
